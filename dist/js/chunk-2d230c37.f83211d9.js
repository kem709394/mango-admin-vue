(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d230c37"],{ee56:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"ios-list-box"}}),e._v("任务列表\n    ")],1),r("Row",[r("Col",{attrs:{span:"12"}},[r("Input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{clearable:"",placeholder:"请输入名称搜搜..."},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}}),r("Button",{attrs:{type:"primary",shape:"circle",icon:"ios-search"},on:{click:e.handleSearch}}),r("Button",{attrs:{type:"text",size:"small",icon:"ios-funnel"},on:{click:e.handleFilter}}),r("Button",{attrs:{type:"text",size:"small",icon:"ios-refresh-circle"},on:{click:e.handleRefresh}})],1),r("Col",{staticStyle:{"text-align":"right"},attrs:{span:"12"}},[e.$checkAccess("sys_task_log_page")?r("Button",{on:{click:e.handleLog}},[e._v("日志")]):e._e(),e.$checkAccess("sys_task_create")?r("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"success"},on:{click:e.handleCreate}},[e._v("添加")]):e._e()],1)],1),r("Row",e._l(e.searchTag,function(t,a){return r("Tag",{key:a},[e._v(e._s(t))])}),1),r("Row",{staticStyle:{"margin-top":"12px"},attrs:{gutter:1}},[r("Table",{attrs:{border:"",columns:e.columns,data:e.pageList,loading:e.pageLoading}})],1),r("Row",{staticStyle:{"margin-top":"10px"}},[r("Page",{attrs:{current:e.pageNum,total:e.pageTotal,"page-size":e.pageRows,"show-sizer":""},on:{"on-change":e.handleChangePage,"on-page-size-change":e.handleChangePageSize}})],1)],1),r("Modal",{attrs:{title:"高级搜索"},on:{"on-ok":e.handleSearch},model:{value:e.searchVisible,callback:function(t){e.searchVisible=t},expression:"searchVisible"}},[r("Form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":100}},[r("FormItem",{attrs:{label:"名称"}},[r("Input",{staticStyle:{width:"300px"},attrs:{clearable:"",placeholder:"Enter something..."},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),r("FormItem",{attrs:{label:"Bean"}},[r("Input",{staticStyle:{width:"300px"},attrs:{clearable:"",placeholder:"Enter something..."},model:{value:e.searchForm.bean,callback:function(t){e.$set(e.searchForm,"bean",t)},expression:"searchForm.bean"}})],1),r("FormItem",{attrs:{label:"状态"}},[r("RadioGroup",{attrs:{type:"button"},model:{value:e.searchForm.state,callback:function(t){e.$set(e.searchForm,"state",t)},expression:"searchForm.state"}},e._l(e.$getDictOptions("TASK_STATE"),function(t,a){return r("Radio",{key:a,attrs:{label:t.code}},[e._v(e._s(t.name))])}),1)],1)],1)],1),r("TaskCreate",{ref:"createModal",on:{callback:e.getData}}),r("TaskUpdate",{ref:"updateModal",on:{callback:e.getData}}),r("TaskDetail",{ref:"detailModal"})],1)},o=[],n=(r("8e6e"),r("ac6a"),r("456d"),r("7f7f"),r("bd86")),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:"添加任务"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("Form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":100}},[r("FormItem",{attrs:{label:"名称",prop:"name"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("FormItem",{attrs:{label:"Bean",prop:"bean"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.bean,callback:function(t){e.$set(e.form,"bean",t)},expression:"form.bean"}})],1),r("FormItem",{attrs:{label:"Cron",prop:"cron"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1),r("FormItem",{attrs:{label:"参数",prop:"params"}},[r("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请填写内容..."},model:{value:e.form.params,callback:function(t){e.$set(e.form,"params",t)},expression:"form.params"}})],1),r("FormItem",{attrs:{label:"说明"}},[r("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请填写内容..."},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),r("Row",{attrs:{slot:"footer",type:"flex",justify:"center"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确认")]),r("Button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")])],1)],1)},i=[],l=r("7618"),c=r("2f62");function m(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach(function(t){Object(n["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var u={data:function(){var e=function(e,t,r){if(""===t)r(new Error("参数不能为空"));else try{var a=JSON.parse(t);"object"===Object(l["a"])(a)?r():r(new Error("参数必须为JSON格式"))}catch(o){r(new Error("参数必须为JSON格式"))}};return{visible:!1,form:{name:"",bean:"",cron:"",params:"",note:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],bean:[{required:!0,message:"Bean不能为空",trigger:"blur"}],cron:[{required:!0,message:"Cron不能为空",trigger:"blur"}],params:[{required:!0,validator:e,trigger:"blur"}]}}},methods:p({},Object(c["b"])("sys/task",["create"]),{init:function(){this.form.name="",this.form.bean="",this.form.cron="",this.form.params="{}",this.form.note="",this.visible=!0},handleSubmit:function(){var e=this;e.$refs.form.validate(function(t){t&&e.create({name:e.form.name,bean:e.form.bean,cron:e.form.cron,params:JSON.parse(e.form.params),note:e.form.note}).then(function(t){0===t.err_code?(e.$emit("callback"),e.visible=!1):e.$Message.error(t.err_msg)})})}})},h=u,f=r("2877"),d=Object(f["a"])(h,s,i,!1,null,null,null),b=d.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:"修改任务"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("Form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":100}},[r("FormItem",{attrs:{label:"名称",prop:"name"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("FormItem",{attrs:{label:"Bean",prop:"bean"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.bean,callback:function(t){e.$set(e.form,"bean",t)},expression:"form.bean"}})],1),r("FormItem",{attrs:{label:"Cron",prop:"cron"}},[r("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写内容..."},model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1),r("FormItem",{attrs:{label:"参数",prop:"params"}},[r("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请填写内容..."},model:{value:e.form.params,callback:function(t){e.$set(e.form,"params",t)},expression:"form.params"}})],1),r("FormItem",{attrs:{label:"说明"}},[r("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请填写内容..."},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),r("Row",{attrs:{slot:"footer",type:"flex",justify:"center"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确认")]),r("Button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")])],1)],1)},y=[];function v(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach(function(t){Object(n["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var O={data:function(){var e=function(e,t,r){if(""===t)r(new Error("参数不能为空"));else try{var a=JSON.parse(t);"object"===Object(l["a"])(a)?r():r(new Error("参数必须为JSON格式"))}catch(o){r(new Error("参数必须为JSON格式"))}};return{visible:!1,detail:null,form:{name:"",bean:"",cron:"",params:"",note:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],bean:[{required:!0,message:"Bean不能为空",trigger:"blur"}],cron:[{required:!0,message:"Cron不能为空",trigger:"blur"}],params:[{required:!0,validator:e,trigger:"blur"}]}}},methods:w({},Object(c["b"])("sys/task",["getDetail","update"]),{init:function(e){var t=this;this.getDetail(e).then(function(e){t.detail=e.info,t.form.name=t.detail.name,t.form.bean=t.detail.bean,t.form.cron=t.detail.cron,t.form.params=JSON.stringify(t.detail.params),t.form.note=t.detail.note,t.visible=!0})},handleSubmit:function(){var e=this;e.$refs.form.validate(function(t){t&&e.update({id:e.detail.id,data:{name:e.form.name,bean:e.form.bean,cron:e.form.cron,params:JSON.parse(e.form.params),note:e.form.note}}).then(function(t){0===t.err_code?(e.$emit("callback"),e.visible=!1):e.$Message.error(t.err_msg)})})}})},k=O,_=Object(f["a"])(k,g,y,!1,null,null,null),F=_.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:"任务详情","footer-hide":""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.detail?r("Form",{attrs:{"label-width":100}},[r("FormItem",{attrs:{label:"名称"}},[e._v(e._s(e.detail.name))]),r("FormItem",{attrs:{label:"Bean"}},[e._v(e._s(e.detail.bean))]),r("FormItem",{attrs:{label:"Cron"}},[e._v(e._s(e.detail.cron))]),r("FormItem",{attrs:{label:"参数"}},[e._v(e._s(e.detail.params))]),r("FormItem",{attrs:{label:"状态"}},[e._v(e._s(e.$tranDictName("TASK_STATE",e.detail.state)))]),r("FormItem",{attrs:{label:"说明"}},[e._v(e._s(e.detail.note))]),r("FormItem",{attrs:{label:"创建"}},[e._v(e._s(e.$moment(e.detail.createTime).format("YYYY-MM-DD HH:mm")))]),e.detail.modifyTime?r("FormItem",{attrs:{label:"修改"}},[e._v(e._s(e.$moment(e.detail.modifyTime).format("YYYY-MM-DD HH:mm")))]):e._e()],1):e._e()],1)},j=[];function S(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(r,!0).forEach(function(t){Object(n["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var P={data:function(){return{visible:!1,detail:null}},methods:D({},Object(c["b"])("sys/task",["getDetail"]),{init:function(e){var t=this;this.getDetail(e).then(function(e){t.detail=e.info,t.visible=!0})}})},$=P,I=Object(f["a"])($,x,j,!1,null,null,null),T=I.exports;function M(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(r,!0).forEach(function(t){Object(n["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var E={name:"sys_task",components:{TaskCreate:b,TaskUpdate:F,TaskDetail:T},data:function(){var e=this;return{searchVisible:!1,searchForm:{name:"",bean:"",state:""},searchTag:[],columns:[{title:"名称",key:"name"},{title:"Bean",key:"bean"},{title:"Cron",key:"cron"},{title:"状态",render:function(t,r){return t("span",e.$tranDictName("TASK_STATE",r.row.state))}},{title:"操作",width:230,align:"center",render:function(t,r){var a=[];e.$checkAccess("sys_task_detail")&&a.push(t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.handleDetail(r.row)}}},"详情")),e.$checkAccess("sys_task_update")&&a.push(t("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.handleUpdate(r.row)}}},"修改")),e.$checkAccess("sys_task_delete")&&a.push(t("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.handleDelete(r.row)}}},"删除"));var o=[];return e.$checkAccess("sys_task_execute")&&o.push(t("DropdownItem",{props:{name:"2"}},"执行")),e.$checkAccess("sys_task_start")&&"0"===r.row.state&&o.push(t("DropdownItem",{props:{name:"1"}},"启动")),e.$checkAccess("sys_task_stop")&&"1"===r.row.state&&o.push(t("DropdownItem",{props:{name:"0"}},"停止")),o.length>0&&a.push(t("Dropdown",{props:{transfer:!0},on:{"on-click":function(t){e.handleMore(r.row,t)}}},[t("Button",{props:{type:"default",size:"small"}},["控制",t("Icon",{props:{type:"md-arrow-dropdown"}})]),t("DropdownMenu",{slot:"list"},o)])),t("div",a)}}]}},computed:R({},Object(c["c"])("sys/task",["pageFilter","pageNum","pageRows","pageList","pageTotal","pageLoading"])),mounted:function(){this.init()},methods:R({},Object(c["b"])("sys/task",["getData","delete","operate"]),{},Object(c["d"])("sys/task",["setPageNum","setPageRows","setPageFilter"]),{init:function(){this.getData()},handleChangePage:function(e){this.setPageNum(e),this.getData()},handleChangePageSize:function(e){this.setPageNum(1),this.setPageRows(e),this.getData()},handleFilter:function(){this.searchVisible=!0},handleSearch:function(){this.searchTag=[];var e={};""!==this.searchForm.name.trim()&&(e.name=this.searchForm.name.trim(),this.searchTag.push("名称："+this.searchForm.name.trim())),""!==this.searchForm.bean.trim()&&(e.bean=this.searchForm.bean.trim(),this.searchTag.push("Bean："+this.searchForm.bean.trim())),""!==this.searchForm.state&&(e.state=this.searchForm.state,this.searchTag.push("状态："+this.$tranDictName("TASK_STATE",this.searchForm.state))),this.setPageFilter(e),this.setPageNum(1),this.getData()},handleRefresh:function(){this.searchTag=[],this.searchForm.name="",this.searchForm.bean="",this.searchForm.state="",this.setPageFilter({}),this.setPageNum(1),this.getData()},handleLog:function(){this.$router.push({name:"sys_task_log"})},handleCreate:function(){this.$refs.createModal.init()},handleUpdate:function(e){this.$refs.updateModal.init(e.id)},handleDetail:function(e){this.$refs.detailModal.init(e.id)},handleMore:function(e,t){var r=this;r.operate({id:e.id,command:t}).then(function(e){0===e.err_code?(r.$Message.success("操作成功"),r.getData()):r.$Message.error(e.err_msg)})},handleDelete:function(e){var t=this;t.$Modal.confirm({title:"确认删除",content:"<p>确认要把当前角色删除吗？</p>",loading:!0,onOk:function(){t.delete(e.id).then(function(e){t.$Modal.remove(),0===e.err_code?(t.$Message.info("删除成功"),t.pageNum>1&&1===t.pageList.length&&t.setPageNum(t.pageNum-1),t.getData()):t.$Message.error(e.err_msg)})}})}})},N=E,B=Object(f["a"])(N,a,o,!1,null,"34cbd3e0",null);t["default"]=B.exports}}]);